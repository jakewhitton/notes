#!/bin/sh

# If a parameter was passed, exit
if [ $# -ne 0 ]; then
	echo "Incorrect usage.  This script takes no parameters."
	echo "usage: ugenmaster"
	exit -1
fi

REPO_DIR="/home/jake/notes"

NOTES_DIR="${REPO_DIR}/notes"

# If you want to omit certain directories from being detected as units, add them here
UNIT_BLACKLIST=("${NOTES_DIR}")

# Set IFS to newline, so that we can iterate over directories that have tabs or spaces in their names
IFS="
"

for dir in `find "$NOTES_DIR" -type d -not -path '*/\.*' | sort`; do # Iterate over each non-hidden(e.g. .git/) subdirectory
	
	# If $dir is equivalent to one of the elements of $UNIT_BLACKLIST, continue to the next iteration of the loop(skip the current value)
	for blacklisted_directory in "${UNIT_BLACKLIST[@]}"; do
		if [ "$dir" == "$blacklisted_directory" ]; then
			continue 2;
		fi
	done
	
	# Now that we know $dir isn't blacklisted, we call genmaster on it if it contains markdown files
	if ls "$dir"/*.md &> /dev/null; then
		genmaster "$dir"
	fi
done
